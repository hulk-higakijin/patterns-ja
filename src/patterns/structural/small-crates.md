# 小さなクレートを優先する

## 説明

一つのことを上手くこなす小さなクレートを優先しましょう。

CargoとCrates.ioは、サードパーティライブラリの追加を非常に簡単にします。
CやC++などと比べてはるかに簡単です。さらに、crates.io上のパッケージは公開後に編集や削除ができないため、
現在動作するビルドは将来も動作し続けるはずです。
私たちはこのツールを活用し、より小さく、より細かい粒度の依存関係を使用すべきです。

## 利点

- 小さなクレートは理解しやすく、よりモジュール化されたコードを促進します。
- クレートはプロジェクト間でコードを再利用できます。例えば、`url`クレートは
  Servoブラウザエンジンの一部として開発されましたが、その後プロジェクト外で広く使用されています。
- Rustのコンパイル単位はクレートであるため、プロジェクトを複数のクレートに分割することで、
  より多くのコードを並列でビルドできます。

## 欠点

- プロジェクトが同時に同じクレートの複数の競合するバージョンに依存する場合、
  「依存関係地獄」につながる可能性があります。例えば、`url`クレートには
  バージョン1.0と0.5の両方があります。`url:1.0`の`Url`と`url:0.5`の`Url`は
  異なる型であるため、`url:0.5`を使用するHTTPクライアントは、
  `url:1.0`を使用するWebスクレイパーからの`Url`値を受け入れません。
- crates.io上のパッケージはキュレーションされていません。クレートは不十分に書かれていたり、
  役に立たないドキュメントを持っていたり、明らかに悪意があったりする可能性があります。
- コンパイラはデフォルトでリンク時最適化（LTO）を実行しないため、
  2つの小さなクレートは1つの大きなクレートよりも最適化されていない可能性があります。

## 例

[`url`](https://crates.io/crates/url)クレートは、URLを扱うためのツールを提供します。

[`num_cpus`](https://crates.io/crates/num_cpus)クレートは、マシンのCPU数を
照会する関数を提供します。

[`ref_slice`](https://crates.io/crates/ref_slice)クレートは、`&T`を`&[T]`に
変換する関数を提供します。（歴史的な例）

## 参照

- [crates.io: Rustコミュニティのクレートホスト](https://crates.io/)